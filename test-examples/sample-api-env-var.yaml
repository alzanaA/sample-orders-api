requirements: {}
configs: 
  base_url: https://sample-url.com #export env variable `export base_url="https://sample-api.us-east-a.apiconnect.automation.ibm.com"`
  api_key: "cadsfghj"
  value: 200
  map1: 
    path1: branches1
    path: branches
  boolean: true
  array:
    - array1
    - payload
    - application/swagger+yaml
  XIBMClientID: placeholder
steps:
  - type: request
    method: get
    url: "{{ configs.base_url }}/bank/{{map1.path}}"
    headers:
      Authorization: "Bearer {{ configs.api_key }}"
    var: branches
    mode: json
  - type: assert-is
    expression: branches
    value: array
  - type: assert-exists 
    expression: branches.[1]
    stoponfail: "{{ configs.boolean }}"
  - type: assert-is 
    expression: branches.[0].type
    value: string
    stoponfail: true    
  - type: assert-is 
    expression: branches.[0].address.city
    value: string
    stoponfail: true    
  - type: request
    method: get
    url: https://sample-api.us-east-a.apiconnect.automation.ibm.com/orders/order/AB1234
    var: "{{ configs.array.[1] }}"
    mode: json
  - type: assert-equals 
    expression: payload_response_statusCode
    value: "{{ configs.value }}"
    ifexists: false
    stoponfail: false
  - type: assert-equals 
    expression: payload_response_header_Content-Type
    value: application/json
  - type: assert-in 
    expression: payload_response_header_Content-Type
    values: 
      - application/json
      - "{{ configs.array.[2] }}"
  - type: assert-contains 
    expression: payload_response_header_Content-Type
    value: app
  - type: assert-matches 
    expression: payload_response_header_Content-Type
    value: ^[a-z]+/json
  - type: assert-exists 
    expression: "payload"  
    stoponfail: false
  - type: assert-is 
    expression: "payload.tracking_reference"
    value: "string"
    ifexists: "false" 
    stoponfail: false
  - type: assert-exists 
    expression: payload.shipped_at
    stoponfail: false
  - type: assert-exists 
    expression: payload.status
    stoponfail: false
  - type: assert-exists 
    expression: payload.created_at  
    stoponfail: false
