requirements: {}
configs: # TODO Add support for variables from config block
  XIBMClientID: placeholder
steps:
  - type: request
    method: get
    url: https://sample-api.us-east-a.apiconnect.automation.ibm.com/bank/branches
    var: branches
    mode: json
  - type: assert-is
    expression: branches
    value: array
  - type: assert-exists 
    expression: branches.[1]
    stoponfail: true
  - type: assert-is 
    expression: branches.[0].type
    value: string
    stoponfail: true    
  - type: assert-is 
    expression: branches.[0].address.city
    value: string
    stoponfail: true  
  - type: assert-compares 
    expression1: branches.[0].type
    expression2: branches.[7].type  
  - type: request
    method: get
    url: https://sample-api.us-east-a.apiconnect.automation.ibm.com/orders/order/AB1234
    var: payload
    mode: json
  - type: assert-equals 
    expression: payload_response_statusCode
    value: 200
    ifexists: false
    stoponfail: false
  - type: assert-equals 
    expression: payload_response_header_Content-Type
    value: application/json
  - type: assert-in 
    expression: payload_response_header_Content-Type
    values: 
      - application/json
      - application/swagger+yaml
  - type: assert-contains 
    expression: payload_response_header_Content-Type
    value: app
  - type: assert-matches 
    expression: payload_response_header_Content-Type
    value: ^[a-z]+/json
  - type: assert-exists 
    expression: "payload"  
    stoponfail: false
  - type: assert-is 
    expression: "payload.tracking_reference"
    value: "string"
    ifexists: "false" 
    stoponfail: false
  - type: assert-exists 
    expression: payload.shipped_at
    stoponfail: false
  - type: assert-exists 
    expression: payload.status
    stoponfail: false
  - type: assert-exists 
    expression: payload.created_at  
    stoponfail: false
